cmake_minimum_required(VERSION 3.15)
project(CalcApp LANGUAGES CXX)

set(CMAKE_CXX_STANDARD 17)
set(CMAKE_RUNTIME_OUTPUT_DIRECTORY ${CMAKE_BINARY_DIR}/bin)

# Use the vcpkg toolchain if VCPKG_ROOT is set
if(DEFINED ENV{VCPKG_ROOT})
  set(CMAKE_TOOLCHAIN_FILE "$ENV{VCPKG_ROOT}/scripts/buildsystems/vcpkg.cmake"
      CACHE STRING "")
  set(VCPKG_INSTALLED_DIR "$ENV{VCPKG_ROOT}/installed/x64-windows")
else()
  message(WARNING "VCPKG_ROOT not defined, you must set it to your vcpkg folder")
endif()

# Locate PDCurses headers and library under the triplet folder
find_path(PDCURSES_INCLUDE_DIR
  NAMES curses.h
  HINTS "${VCPKG_INSTALLED_DIR}/include"
)

find_library(PDCURSES_LIBRARY
  NAMES pdcurses pdcursesw
  HINTS "${VCPKG_INSTALLED_DIR}/lib"
)

if(NOT PDCURSES_INCLUDE_DIR OR NOT PDCURSES_LIBRARY)
  message(FATAL_ERROR "Could not find PDCurses in ${VCPKG_INSTALLED_DIR}")
endif()

# Your executable
add_executable(calc
  src/main.cpp
  src/utility.cpp
  src/insurance.cpp
  src/ui.cpp
)

# Include and link
target_include_directories(calc PRIVATE
  src
  ${PDCURSES_INCLUDE_DIR}
)

target_link_libraries(calc PRIVATE
  ${PDCURSES_LIBRARY}
)
